(function() {
  var locaweb = locaweb || {}
  locaweb.barra = (function() {
    'use strict';

    function init(config) {
      insertStylesheet();
      loadConfig(config);
    }

    function loadConfig (config) {
      var scripts = document.getElementsByTagName( 'script' );
      var scriptTag = scripts[ scripts.length - 1 ];
      console.log(scriptTag)
      for (var prop in scriptTag.dataset) {
        if (scriptTag.dataset.hasOwnProperty(prop)) {
          console.log(scriptTag.dataset )
          config[prop] = scriptTag.dataset[prop] || config[prop];
        }
      }
      insertFooter(config);
      insertHeader(config);
    }

    function insertStylesheet(){
      utils._appendHtml( document.head, JST['barra-locaweb/_style']() );
    }

    function insertFooter(config){
      utils._appendHtml(document.body, JST["barra-locaweb/_footer"]( config ));
    }

    function insertHeader(config){
      utils._prependHtml(document.body, JST["barra-locaweb/_header"]( config ));
    }

    var utils = (function() {
    
      function appendHtml(el, str) {
        var div = document.createElement('div');
        div.innerHTML = str;
        while (div.children.length > 0) {
          el.appendChild(div.children[0]);
        }
      }

      function prependHtml (el, str) {
        var div = document.createElement('div');
        div.innerHTML = str;
        document.body.insertBefore(div.children[0], document.body.firstChild);
      }

      return {
        _appendHtml  : appendHtml,
        _prependHtml : prependHtml,
      };
    
    }());


    return {
      init:init
    };

  }());
  locaweb.barra.init( barraConfig );
})();